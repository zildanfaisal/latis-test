[build]
builder = "NIXPACKS"
# Urutan diperbaiki: install PHP deps (dev dihapus), install JS (termasuk dev) untuk build, lakukan build Vite,
# lalu prune dev dependencies JS agar image lebih kecil. 'npm prune --production' lebih cepat dibanding npm ci ulang.
# Jika perlu paket dev PHP untuk build (misal pint format, dll), hilangkan --no-dev.
buildCommand = "composer install --no-dev --optimize-autoloader && npm ci && npm run build && npm prune --production"

[start]
command = "php artisan serve --host 0.0.0.0 --port ${PORT}"

[variables]
APP_ENV = "production"
APP_DEBUG = "false"
